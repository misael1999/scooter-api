swagger: '2.0'
info:
  title: SCOOTER API REST
  description: It is API to scooter app
  termsOfService: https://www.google.com/policies/terms/
  contact:
    email: misael.gonzalez.e.229@gmail.com
  license:
    name: BSD License
  version: v1
basePath: /appback/
consumes:
  - application/json
produces:
  - application/json
securityDefinitions:
  Basic:
    type: basic
  bearerAuth:
    type: http
    scheme: bearer
    bearerFormat: JWT
security:
  - Basic: []
  - bearerAuth: []

# ====== PATHS =======
paths:
  # STATUS
  /api/v1/commons/status/:
    get:
      operationId: general_status_get
      description: Return all status.
      parameters: []
      responses:
        '200':
          description: 'Regresa todos los estatus que se ocupan de manera general'
      tags:
        - Común
    parameters: []
  /api/v1/commons/order_status/:
    get:
      operationId: orders_status_get
      description: Listado de status de ordenes.
      parameters: []
      responses:
        '200':
          description: 'Regresa todos los estatus que se ocupan para las ordenes'
      tags:
        - Común
    parameters: []
  /api/v1/commons/schedules/:
    get:
      operationId: schedules_get
      description: Listado de horarios.
      parameters: []
      responses:
        '200':
          description: 'Listado de horarios'
      tags:
        - Común
    parameters: []
  /api/v1/commons/services/:
    get:
      operationId: services_get
      description: Listado de servicios.
      parameters: []
      responses:
        '200':
          description: 'Listado de servicios'
      tags:
        - Común
    parameters: []
  # DEVICES
  /api/v1/devices/:
    post:
      operationId: Register_token_user
      description: Registrar token de usuario para notificaciones push
      parameters:
        - name: body
          in: body
          description: Registrar token de usuario para notificaciones push
          schema:
            $ref: '#/definitions/RegisterTokenUser'
      responses:
        '200':
          description: ''
      tags:
        - Usuarios general
    parameters: []
  # VERIFY ACCOUNT
  /api/v1/users/verify/:
    post:
      operationId: verify_account_customer
      description: Verificar cuenta del cliente
      parameters:
        - name: body
          in: body
          description: Verificar cuenta ingresando el token recibido por correo electronico
          schema:
            $ref: '#/definitions/VerifyAccount'
      responses:
        '200':
          description: 'Información del usuario verificado'
      tags:
        - Usuarios general
    parameters: []
  # FORGOT PASSWORD
  /api/v1/users/forgot-password/:
    post:
      operationId: forgot_password_customer
      description: Correo para obtener token de recuperación
      parameters:
        - name: body
          in: body
          description: Recuperar contraseña
          schema:
            $ref: '#/definitions/ForgotPassword'
      responses:
        '200':
          description: 'Envío de correo para obtener un token de recuperación'
      tags:
        - Usuarios general
    parameters: []
  # RECOVER PASSWORD
  /api/v1/users/recover-password/:
    post:
      operationId: recover_password_customer
      description: Recuperar contraseña del cliente
      parameters:
        - name: body
          in: body
          description: Recuperar contraseña
          schema:
            $ref: '#/definitions/RecoverPassword'
      responses:
        '200':
          description: 'Contraseña cambiada'
      tags:
        - Usuarios general
    parameters: []
  # LOGIN CUSTOMER
  /api/v1/customers/login/:
    post:
      operationId: customer_login
      description: Login de clientes
      parameters:
        - name: body
          in: body
          description: Login
          schema:
            $ref: '#/definitions/LoginToken'
      responses:
        '200':
          description: 'Regresa información del cliente y su access_token'
      tags:
        - Clientes
    parameters: []
  /api/v1/customers/login/facebook/:
    post:
      operationId: customer_login_facebook
      description: Login de clientes
      parameters:
        - name: body
          in: body
          description: Login con facebook
          schema:
            $ref: '#/definitions/LoginCustomerFacebook'
      responses:
        '200':
          description: 'Regresa información del cliente y su access_token'
      tags:
        - Clientes
    parameters: []
  # REGISTER CUSTOMER
  /api/v1/customers/:
    post:
      operationId: register_client
      description: Registro de clientes
      parameters:
        - name: body
          in: body
          description: Registro de clientes
          schema:
            $ref: '#/definitions/RegisterCustomer'
      responses:
        '201':
          description: 'Información del cliente y mensaje'
      tags:
        - Clientes
    parameters: []
  # UPDATE CUSTOMER
  /api/v1/customers/{customer_id}/:
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
    patch:
      operationId: update_client
      description: Actualizar datos del cliente
      parameters:
        - name: body
          in: body
          description: Actualizar datos del cliente
          schema:
            $ref: '#/definitions/UpdateCustomer'
      responses:
        '201':
          description: 'Información del cliente y mensaje'
      tags:
        - Clientes
    get:
      operationId: get_client
      description: Obtener datos del cliente
      responses:
        '201':
          description: 'Información del cliente'
      tags:
        - Clientes
  /api/v1/customers/{customer_id}/change_password/:
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
    patch:
      operationId: change_password_customer
      description: Actualizar contraseña del cliente
      parameters:
        - name: body
          in: body
          description: Actualizar contraseña del cliente
          schema:
            $ref: '#/definitions/ChangePassword'
      responses:
        '201':
          description: 'Información del cliente'
      tags:
        - Clientes
# REGISTER CUSTOMER ADDRESS
  /api/v1/customers/{customer_id}/addresses/:
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
    post:
      operationId: register_customer_address
      description: Registro de direcciones del cliente
      parameters:
        - name: body
          in: body
          description: Registro de direcciones
          schema:
            $ref: '#/definitions/RegisterCustomerAddress'
      responses:
        '201':
          description: 'Información de la dirección'
      tags:
        - Clientes
    get:
      operationId: get_customer_addresses
      description: Obtener direcciones del cliente
      parameters:
        - name: limit
          in: query
          description: Numero de resultados por pagina
          required: false
          type: integer
        - name: offset
          in: query
          description: El índice inicial desde el que devolver los resultados.
          required: false
          type: integer
        - name: sId
          description: ID Status
          required: false
          in: query
          type: integer
        - name: search
          description: Buscar por (nombre)
          in: query
          required: false
          type: string
        - name: orderBy
          description: Order By field
          in: query
          required: false
          type: string
          enum: ['checker_name', 'status', 'created_at']
      responses:
        '201':
          description: 'Listado de direcciones'
      tags:
        - Clientes
  /api/v1/customers/{customer_id}/addresses/{address_id}/:
  # GET INFO CUSTUMER ADDRESS
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
      - name: address_id
        in: path
        required: true
        type: string
# UPDATE CUSTOMER ADDRESS
    patch:
      operationId: update_customer_address
      description: Actualización de direcciones del cliente
      parameters:
        - name: body
          in: body
          description: Actualización de direcciones
          schema:
            $ref: '#/definitions/RegisterCustomerAddress'
      responses:
        '201':
          description: 'Información de la dirección'
      tags:
        - Clientes
    get:
      operationId: get_customer_address
      description: Obtener datos de la dirección
      responses:
        '201':
          description: 'Información de la dirección'
      tags:
        - Clientes
    delete:
      operationId: delete_customer_address
      description: Borrar dirección
      responses:
        '201':
          description: 'Información de la dirección'
      tags:
        - Clientes

  # ========== BEGIN STATIONS =================
  # STATION LOGIN
  /api/v1/stations/login/:
    post:
      operationId: station_login
      description: Login de centrales
      parameters:
        - name: body
          in: body
          description: Login
          schema:
            $ref: '#/definitions/LoginToken'
      responses:
        '200':
          description: 'Regresa información del cliente y su access_token'
      tags:
        - Centrales
    parameters: []
  # REGISTER STATIONS
  /api/v1/stations/:
    post:
      operationId: register_station
      description: Registro de centrales
      parameters:
        - name: body
          in: body
          description: Registro de centrales
          schema:
            $ref: '#/definitions/RegisterStation'
      responses:
        '201':
          description: 'Información de la central'
      tags:
        - Centrales
    get:
      operationId: list_stations
      description: listado de todas las centrales.
      parameters:
        - name: limit
          in: query
          description: Numero de resultados por pagina
          required: false
          type: integer
        - name: offset
          in: query
          description: El índice inicial desde el que devolver los resultados.
          required: false
          type: integer
        - name: sId
          description: ID Status
          required: false
          in: query
          type: integer
        - name: search
          description: Buscar por (nombre)
          in: query
          required: false
          type: string
        - name: orderBy
          description: Order By field
          in: query
          required: false
          type: string
          enum: ['checker_name', 'status', 'created_at']
      responses:
        '200':
          description: 'Listado de centrales'
      tags:
        - Centrales
    parameters: []
  # UPDATE STATIONS
  /api/v1/stations/{id}/update_info/:
    parameters:
      - name: id
        in: path
        required: true
        type: string
    patch:
      operationId: update_station
      description: Actualizar datos de la central
      parameters:
        - name: body
          in: body
          description: Actualizar datos de la central
          schema:
            $ref: '#/definitions/UpdateStation'
      responses:
        '201':
          description: 'Información de la central'
      tags:
        - Centrales
    put:
      operationId: update_station_put
      description: Actualizar datos de la central
      parameters:
        - name: body
          in: body
          description: Actualizar datos de la central
          schema:
            $ref: '#/definitions/UpdateStation'
      responses:
        '201':
          description: 'Información de la central'
      tags:
        - Centrales

  # CREATE DELIVERY MAN BY STATION
  /api/v1/stations/{station_id}/delivery_men/:
    parameters:
      - name: station_id
        in: path
        required: true
        type: string
    post:
      operationId: register_delivery
      description: Registro de repartidores
      parameters:
        - name: body
          in: body
          description: Registro de repartidores
          schema:
            $ref: '#/definitions/RegisterDeliveryMan'
      responses:
        '201':
          description: 'Información de la central'
      tags:
        - Centrales
    # UPDATE DELIVERY MAN BY STATION
    patch:
      operationId: update_delivery
      description: Actualizar datos del repartidor
      parameters:
        - name: body
          in: body
          description: Actualizar datos del repartidor
          schema:
            $ref: '#/definitions/UpdateDeliveryMan'
      responses:
        '201':
          description: 'Información del repartidor'
      tags:
        - Centrales
    get:
      operationId: list_delivery_man_stations
      description: listado de todos los repartidores por centrales.
      parameters:
        - name: limit
          in: query
          description: Numero de resultados por pagina
          required: false
          type: integer
        - name: offset
          in: query
          description: El índice inicial desde el que devolver los resultados.
          required: false
          type: integer
        - name: sId
          description: ID Status
          required: false
          in: query
          type: integer
        - name: search
          description: Buscar por (nombre)
          in: query
          required: false
          type: string
        - name: orderBy
          description: Order By field
          in: query
          required: false
          type: string
          enum: ['checker_name', 'status', 'created_at']
      responses:
        '201':
          description: 'Información del repartidor'
      tags:
        - Centrales
  /api/v1/stations/{station_id}/vehicles/:
    parameters:
      - name: station_id
        in: path
        required: true
        type: string
    # CREATE VEHICLE BY STATION
    post:
      operationId: register_vehicle
      description: Registro de vehiculos
      parameters:
        - name: body
          in: body
          description: Registro de vehiculos
          schema:
            $ref: '#/definitions/RegisterVehicle'
      responses:
        '201':
          description: 'Información del repartidor creado'
      tags:
        - Centrales
    get:
      operationId: get_vehicles_station
      description: Obtener datos del vehiclo
      parameters:
        - name: limit
          in: query
          description: Numero de resultados por pagina
          required: false
          type: integer
        - name: offset
          in: query
          description: El índice inicial desde el que devolver los resultados.
          required: false
          type: integer
        - name: sId
          description: ID Status
          required: false
          in: query
          type: integer
        - name: search
          description: Buscar por (nombre)
          in: query
          required: false
          type: string
        - name: orderBy
          description: Order By field
          in: query
          required: false
          type: string
          enum: ['checker_name', 'status', 'created_at']
      responses:
        '201':
          description: 'Listado de vehiculos por central'
      tags:
        - Centrales
  /api/v1/stations/{station_id}/vehicles/{vehicle_id}/:
    parameters:
      - name: station_id
        in: path
        required: true
        type: string
      - name: vehicle_id
        in: path
        required: true
        type: string
  # UPDATE VEHICLE BY STATION
    patch:
      operationId: update_vehicle
      description: Actualizar datos del vehiculo
      parameters:
        - name: body
          in: body
          description: Actualizar datos del vehiculo
          schema:
            $ref: '#/definitions/UpdateVehicle'
      responses:
        '201':
          description: 'Información del vehiculo'
      tags:
        - Centrales
    # GET INFO VEHICLE BY STATION
    get:
      operationId: get_vehicle
      description: Obtener datos del vehiculo
      responses:
        '201':
          description: 'Información del vehiculo'
      tags:
        - Centrales
    delete:
      operationId: delete_vehicle
      description: Borra vehiculo
      responses:
        '201':
          description: 'Información del vehiculo'
      tags:
        - Centrales
  # ========== END STATIONS =================
  # ========= BEGIN DELIVERY MAN ============
  /api/v1/delivery_men/login/:
    post:
      operationId: delivery_man_login
      description: Login de repartidores
      parameters:
        - name: body
          in: body
          description: Login de repartidores
          schema:
            $ref: '#/definitions/LoginDeliveryMan'
      responses:
        '200':
          description: 'Regresa información del repartidor y su access_token'
      tags:
        - Repartidores
    parameters: []
  /api/v1/delivery_men/{delivery_id}/:
    parameters:
      - name: delivery_id
        in: path
        required: true
        type: string
    patch:
      operationId: update_delivery_man
      description: Actualizar repartidores
      parameters:
        - name: body
          in: body
          description: Actualizar repartidor
          schema:
            $ref: '#/definitions/UpdateDeliveryManId'
      responses:
        '200':
          description: 'Regresa información del repartidor y su access_token'
      tags:
        - Repartidores
  /api/v1/delivery_men/{delivery_man_id}/update_location/:
    parameters:
      - name: delivery_man_id
        in: path
        required: true
        type: string
    patch:
      operationId: delivery_man_update_location
      description: Actualizar ubicación del repartidor
      parameters:
        - name: body
          in: body
          description: Actualizar ubicación del repartidor
          schema:
            $ref: '#/definitions/UpdateLocationDeliveryMan'
      responses:
        '200':
          description: 'Ubicación actualizada'
      tags:
        - Repartidores
  # ==== ORDERS =====
  /api/v1/customers/{customer_id}/orders/:
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
    post:
      operationId: create_order_customer
      description: Crear pedido
      parameters:
        - name: body
          in: body
          description: Crear un nuevo pedido
          schema:
            $ref: '#/definitions/CreateOrder'
      responses:
        '200':
          description: 'Pedido creado'
      tags:
        - Pedidos
  /api/v1/customers/{customer_id}/orders/service_price/:
    parameters:
      - name: customer_id
        in: path
        required: true
        type: string
    post:
      operationId: calculate_price_order_customer
      description: Calcular el precio del servicio
      parameters:
        - name: body
          in: body
          description: Calcular el precio del servicio
          schema:
            $ref: '#/definitions/CalculatePriceOrder'
      responses:
        '200':
          description: 'Pedido creado'
      tags:
        - Pedidos

# ======== DEFINITIONS ==============
definitions:
  # LOGIN CUSTOMER
  RegisterTokenUser:
    type: object
    properties:
      registration_id:
        type: string
        description: Token de FCM
      type:
        type: string
        example: 'android'
        description: Tipo de dispositivo
    required:
      - registration_id
      - type
  LoginToken:
    type: object
    properties:
      username:
        type: string
        description: Correo
      password:
        type: string
        description: Contraseña
    required:
      - username
      - password
  # LOGIN CUSTOMER
  LoginCustomerFacebook:
    type: object
    properties:
      access_token:
        type: string
        description: Token de facebook
    required:
      - access_token
  # FORGOT PASSWORD
  ForgotPassword:
    type: object
    properties:
      username:
        type: string
        description: Correo
      required:
        - username
  VerifyAccount:
    type: object
    properties:
      token:
        type: string
        description: Token
      required:
        - token
  # RECOVER PASSWORD
  RecoverPassword:
    type: object
    properties:
      token:
        type: string
        description: Token de recuperación
      password:
        type: string
        description: Nueva contraseña
      required:
        - token
        - password
  # REGISTER CUSTOMER
  RegisterCustomer:
    type: object
    properties:
      username:
        type: string
        description: Correo
      password:
        type: string
        description: Contraseña
      name:
        type: string
        description: Nombre(s) del cliente
      birthdate:
        type: string
        description: Fecha de nacimiento
        format: date
        example: '2019-05-19'
      phone_number:
        type: string
        description: Numero de teléfono
    required:
      - username
      - password
      - name
  # UPDATE CUSTOMER
  UpdateCustomer:
    type: object
    properties:
      name:
        type: string
        description: Nombre(s) del cliente
      birthdate:
        type: string
        description: Fecha de nacimiento
        format: date
        example: '2019-05-19'
      phone_number:
        type: string
        description: Numero de teléfono
      picture:
        type: string
        description: Imagen de perfil
  ChangePassword:
    type: object
    properties:
      current_password:
        type: string
        description: Contraseña actual
      new_password:
        type: string
        description: Nueva contraseña
    required:
      - new_password
      - current_password
  # REGISTER CUSTOMER ADDRESS
  RegisterCustomerAddress:
    type: object
    properties:
      alias:
        type: string
        description: Alias de la dirección
      street:
        type: string
        description: Calle
      suburb:
        type: string
        description: Colonia
      type_address:
        type: number
        exmaple: 1
        description: Tipo de direccion (personal, compra)
      postal_code:
        type: string
        description: Código postal
      exterior_number:
        type: string
        description: Número exterior
      inside_number:
        type: string
        description: Número interior
      references:
        type: string
        description: Referencias
      point:
        type: object
        properties:
          lat:
            type: number
            description: Latitude
            example: 18.462859841665864
          lng:
            type: number
            description: Longitude
            example: -97.39279966871719
    required:
      - alias
      - street
      - suburb
      - postal_code
      - exterior_number
      - references
# UPDATE CUSTOMER ADDRESS
  UpdateCustomerAddress:
    type: object
    properties:
      alias:
        type: string
        description: Alias de la dirección
      street:
        type: string
        description: Calle
      suburb:
        type: string
        description: Colonia
      postal_code:
        type: string
        description: Código postal
      exterior_number:
        type: string
        description: Número exterior
      inside_number:
        type: string
        description: Número interior
      references:
        type: string
        description: Referencias
      point:
        type: object
        properties:
          lat:
            type: number
            description: Latitude
          lng:
            type: number
            description: Longitud
  # ========== END CUSTOMER =============
  # REGISTER STATION
  RegisterStation:
    type: object
    properties:
      username:
        type: string
        description: Correo
      password:
        type: string
        description: Contraseña
      station_name:
        type: string
        description: Nombre de la central
      contact_person:
        type: string
        description: Persona de contacto
    required:
      - username
      - password
      - station_name
      - contact_person
  # UPDATE STATION
  UpdateStation:
    type: object
    properties:
      general:
        type: object
        properties:
          picture:
            type: string
            example: 'data:image/png;base64,....'
      config:
        type: object
        properties:
          assign_delivery_manually:
            type: boolean
            example: true
            description: Asignar repartidor de manera manual
          allow_cancellations:
            type: boolean
            example: true
            description: Permitir cancelaciones
          cancellation_policies:
            type: string
            example: Politica 1, no se permite ...
            description: Politicas de cancelaciones
          schedules:
            type: array
            description: Lista de horarios
            items:
              type: object
              properties:
                schedule_id:
                  type: number
                  description: Id del día
                  example: 1
                from_hour:
                  type: string
                  example: '10:00'
                  description: Desde la hora ...
                to_hour:
                  type: string
                  example: '18:00'
                  description: Hasta la hora ...
      services:
        type: array
        description: Lista de servicios con sus precios
        items:
          type: object
          properties:
            service_id:
              type: number
              description: Id del servicio
              example: 1
            base_rate_price:
              type: number
              description: Precio base
              example: 20
            price_kilometer:
              type: number
              description: Precio por cada kilometro
              example: 3
            from_kilometer:
              type: number
              description: Desde que kilometro el precio base
              example: 0
            to_kilometer:
              type: number
              description: Hasta que kilometro el precio base
              example: 5
      address:
        type: object
        properties:
          alias:
            type: string
            description: Alias de la dirección
          street:
            type: string
            description: Calle
          suburb:
            type: string
            description: Colonia
          postal_code:
            type: string
            description: Código postal
          exterior_number:
            type: string
            description: Número exterior
          inside_number:
            type: string
            description: Número interior
          references:
            type: string
            description: Referencias
          point:
            type: object
            properties:
              lat:
                type: number
                description: Latitude
                example: 18.462859841665864
              lng:
                type: number
                description: Longitude
                example: -97.39279966871719
  # ======== BEGIN DELIVERY MAN BY STATION ============
  # REGISTER DELIVERY MAN
  RegisterDeliveryMan:
    type: object
    properties:
      name:
        type: string
        description: Nombre(s) del repartidor
      last_name:
        type: string
        description: Apellidos del repartidor
      phone_number:
        type: string
        description: Teléfono del repartidor para iniciar sesión
      salary_per_order:
        type: number
        description: Pago por orden
      password:
        type: string
        description: Contraseña para inicio de sesión
  UpdateDeliveryMan:
    type: object
    properties:
      name:
        type: string
        description: Nombre(s) del repartidor
      last_name:
        type: string
        description: Apellidos del repartidor
      phone_number:
        type: string
        description: Teléfono del repartidor para iniciar sesión
      salary_per_order:
        type: number
        description: Pago por orden
      password:
        type: string
        description: Contraseña para inicio de sesión
  UpdateDeliveryManId:
    type: object
    properties:
      picture:
        type: string
        description: Imagen del repartidor
  # VEHICLE'S STATION
  RegisterVehicle:
    type: object
    properties:
      alias:
        type: string
        description: Alias del vehiculo
      model:
        type: string
        description: Modelo del vehiculo
      year:
        type: string
        description: Año del vehiculo
      plate:
        type: string
        description: Placa del vehiculo
    required:
      - alias
  UpdateVehicle:
    type: object
    properties:
      alias:
        type: string
        description: Alias del vehiculo
      model:
        type: string
        description: Modelo del vehiculo
      year:
        type: string
        description: Año del vehiculo
      plate:
        type: string
        description: Placa del vehiculo
    required:
      - alias
  # DELIVERY MAN
  LoginDeliveryMan:
    type: object
    properties:
      username:
        type: string
        description: Correo
      password:
        type: string
        description: Contraseña
    required:
      - username
      - password
  UpdateLocationDeliveryMan:
    type: object
    properties:
      latitude:
        type: number
        description: Latitude
        example: 18.462859841665864
      longitude:
        type: number
        description: Longitude
        example: -97.39279966871719
    required:
      - latitude
      - longitude
  # ==== ORDERS
  CalculatePriceOrder:
    type: object
    properties:
      station_id:
        type: number
        description: Id de la estación
        example: 1
      service_id:
        type: number
        description: Id del servicio
        example: 1
      from_address_id:
        type: number
        description: Id de la dirección para compra o recolección
        example: 1
      to_address_id:
        type: number
        description: Id de la dirección de entrega
        example: 1
    required:
      - station_id
      - service_id
      - from_address_id
      - to_address_id
  CreateOrder:
    type: object
    properties:
      station_id:
        type: number
        description: Id de la estación
        example: 1
      service_id:
        type: number
        description: Id del servicio
        example: 1
      from_address_id:
        type: number
        description: Id de la dirección para compra o recolección
        example: 1
      to_address_id:
        type: number
        description: Id de la dirección de entrega
        example: 1
      service_price:
        type: number
        description: Precio consultado previamente
        example: 25.0
      indications:
        type: string
        description: Indicaciones del pedido
        example: Quiero que el producto este ...
      approximate_price_order:
        type: number
        description: Precio aproximado de la compra
        example: 100.0
      details:
        type: array
        description: Lista de productos
        items:
          type: object
          properties:
            product_name:
              type: string
              description: Nombre del producto
              example: Arroz
            picture:
              type: string
              description: Imagen del producto
              example: base64Image
    required:
      - station_id
      - service_id
      - from_address_id
      - to_address_id
      - service_price
      - approximate_price_order
      - details
